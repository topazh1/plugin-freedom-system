<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PadForge UI Mockup v1</title>

  <style>
    /* CRITICAL: WebView constraints */
    html, body {
      height: 100%;  /* REQUIRED - replaces viewport units */
      margin: 0;
      padding: 0;
    }

    *, *::before, *::after {
      box-sizing: border-box;
    }

    body {
      /* Native application feel */
      user-select: none;
      -webkit-user-select: none;
      cursor: default;
      overflow: hidden;

      /* Center preview frame */
      display: flex;
      align-items: center;
      justify-content: center;
      background: #000;
    }

    /* Fixed-size preview frame (test HTML only) */
    .plugin-frame {
      width: 400px;
      height: 350px;
      border: 2px solid #444;
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
      overflow: hidden;
      position: relative;
    }

    /* Plugin UI container */
    .container {
      width: 100%;
      height: 100%;
      position: relative;

      /* Sandy earth tone background */
      background: #c9a87c;
    }

    /* Fine grain texture overlay */
    .container::before {
      content: '';
      position: absolute;
      inset: 0;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" /></filter><rect width="200" height="200" filter="url(%23noise)" opacity="0.15"/></svg>');
      background-repeat: repeat;
      opacity: 0.15;
      mix-blend-mode: multiply;
      pointer-events: none;
    }

    /* Plugin name header */
    .plugin-name {
      position: absolute;
      top: 23px;
      left: 50%;
      transform: translateX(-50%);
      font-family: Arial, 'Helvetica Neue', sans-serif;
      font-size: 24px;
      font-weight: bold;
      color: #3a2a1a;
      letter-spacing: 1px;
    }

    /* Knob container */
    .knob-group {
      position: absolute;
      top: 55px;
      left: 0;
      right: 0;
      height: 110px;
    }

    /* Individual knob wrapper */
    .knob-wrapper {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .knob-wrapper.volume {
      left: 40px;
      top: 20px;
    }

    .knob-wrapper.brightness {
      left: 165px;
      top: 20px;
    }

    .knob-wrapper.space {
      left: 290px;
      top: 20px;
    }

    .knob-wrapper.randomize-amount {
      left: 270px;
      top: 145px;
    }

    /* Knob label */
    .knob-label {
      font-family: Arial, sans-serif;
      font-size: 13px;
      color: #4a3a2a;
      font-weight: 500;
    }

    /* Knob element */
    .knob {
      position: relative;
      cursor: pointer;
    }

    .knob.large {
      width: 70px;
      height: 70px;
    }

    .knob.small {
      width: 50px;
      height: 50px;
    }

    /* Fixed lighting layer (doesn't rotate) */
    .knob-lighting {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      box-shadow:
        inset -3px -3px 8px rgba(0,0,0,0.4),
        inset 3px 3px 8px rgba(255,255,255,0.25);
      pointer-events: none;
      z-index: 2;
    }

    /* Rotating body layer (texture + indicator) */
    .knob-body {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: #8b6f47;
      transform-origin: center center;
      transition: transform 50ms ease-out;
      z-index: 1;

      /* Bakelite texture */
      background-image:
        radial-gradient(circle at 30% 30%, rgba(212, 184, 150, 0.3), transparent 50%),
        radial-gradient(circle at 70% 70%, rgba(0, 0, 0, 0.2), transparent 50%);
    }

    /* Knob indicator line */
    .knob-indicator {
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 3px;
      height: 20px;
      background: #3a2a1a;
      border-radius: 2px;
    }

    .knob.small .knob-indicator {
      height: 14px;
      top: 6px;
    }

    /* Knob value display */
    .knob-value {
      font-family: Arial, sans-serif;
      font-size: 12px;
      color: #3a2a1a;
      font-weight: normal;
    }

    /* RANDOMIZE button section */
    .randomize-section {
      position: absolute;
      top: 180px;
      left: 0;
      right: 0;
      height: 90px;
    }

    /* RANDOMIZE button (raised tactile) */
    .randomize-button {
      position: absolute;
      left: 80px;
      top: 15px;
      width: 160px;
      height: 60px;

      /* Raised 3D appearance */
      background: linear-gradient(180deg, #b8906a 0%, #9d7a54 50%, #8b6848 100%);
      border: none;
      border-radius: 8px;
      box-shadow:
        0 6px 0 #6a4f36,
        0 8px 12px rgba(0,0,0,0.3),
        inset 0 1px 0 rgba(255,255,255,0.3),
        inset 0 -1px 0 rgba(0,0,0,0.2);

      cursor: pointer;
      transition: all 80ms ease-out;

      font-family: Arial, 'Helvetica Neue', sans-serif;
      font-size: 18px;
      font-weight: bold;
      color: #2a1a0a;
      letter-spacing: 2px;
      text-shadow: 0 1px 0 rgba(255,255,255,0.3);
    }

    .randomize-button:hover {
      background: linear-gradient(180deg, #c89f79 0%, #ad8a64 50%, #9b7858 100%);
      box-shadow:
        0 6px 0 #6a4f36,
        0 8px 16px rgba(0,0,0,0.4),
        inset 0 1px 0 rgba(255,255,255,0.4),
        inset 0 -1px 0 rgba(0,0,0,0.2);
    }

    .randomize-button:active {
      transform: translateY(4px);
      box-shadow:
        0 2px 0 #6a4f36,
        0 4px 8px rgba(0,0,0,0.3),
        inset 0 1px 0 rgba(0,0,0,0.1);
    }

    /* Preset section */
    .preset-section {
      position: absolute;
      top: 285px;
      left: 30px;
      right: 30px;
      height: 50px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* Preset dropdown */
    .preset-dropdown {
      width: 180px;
      height: 30px;
      background: #d4b896;
      border: 1px solid #8b6f47;
      border-radius: 4px;
      box-shadow:
        0 2px 4px rgba(0,0,0,0.2),
        inset 0 1px 0 rgba(255,255,255,0.2);

      font-family: Arial, sans-serif;
      font-size: 13px;
      color: #3a2a1a;
      padding: 0 10px;
      cursor: pointer;
      user-select: none;
    }

    /* Preset buttons (Save/Load) */
    .preset-button {
      width: 70px;
      height: 30px;
      background: linear-gradient(180deg, #b8906a 0%, #9d7a54 100%);
      border: 1px solid #8b6f47;
      border-radius: 4px;
      box-shadow:
        0 2px 4px rgba(0,0,0,0.2),
        inset 0 1px 0 rgba(255,255,255,0.2);

      cursor: pointer;
      transition: all 80ms ease-out;

      font-family: Arial, sans-serif;
      font-size: 13px;
      font-weight: 500;
      color: #2a1a0a;
    }

    .preset-button:hover {
      background: linear-gradient(180deg, #c89f79 0%, #ad8a64 100%);
      box-shadow:
        0 2px 6px rgba(0,0,0,0.3),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }

    .preset-button:active {
      transform: translateY(1px);
      box-shadow:
        0 1px 2px rgba(0,0,0,0.2),
        inset 0 1px 0 rgba(0,0,0,0.1);
    }

    /* Debug monitor (test HTML only) */
    .debug-monitor {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.85);
      color: #0f0;
      font-family: 'Courier New', monospace;
      font-size: 11px;
      padding: 8px 12px;
      border: 1px solid #333;
      border-radius: 4px;
      min-width: 150px;
      pointer-events: none;
      z-index: 10000;
    }

    .debug-label {
      color: #666;
      font-size: 9px;
      margin-bottom: 4px;
      letter-spacing: 1px;
    }

    .debug-param {
      font-weight: bold;
      color: #0f0;
    }

    .debug-value {
      color: #fff;
      margin-top: 2px;
    }

    .debug-normalized {
      color: #888;
      font-size: 10px;
    }
  </style>
</head>
<body>
  <!-- Fixed-size preview frame (test HTML only) -->
  <div class="plugin-frame">
    <!-- Plugin UI container -->
    <div class="container">
      <!-- Plugin name -->
      <div class="plugin-name">PadForge</div>

      <!-- Knobs section -->
      <div class="knob-group">
        <!-- Volume knob -->
        <div class="knob-wrapper volume">
          <div class="knob-label">Volume</div>
          <div class="knob large" data-param="volume" data-min="0" data-max="1" data-value="0.7">
            <div class="knob-lighting"></div>
            <div class="knob-body">
              <div class="knob-indicator"></div>
            </div>
          </div>
          <div class="knob-value" data-display="volume">0.70</div>
        </div>

        <!-- Brightness knob -->
        <div class="knob-wrapper brightness">
          <div class="knob-label">Brightness</div>
          <div class="knob large" data-param="brightness" data-min="0" data-max="1" data-value="0.5">
            <div class="knob-lighting"></div>
            <div class="knob-body">
              <div class="knob-indicator"></div>
            </div>
          </div>
          <div class="knob-value" data-display="brightness">0.50</div>
        </div>

        <!-- Space knob -->
        <div class="knob-wrapper space">
          <div class="knob-label">Space</div>
          <div class="knob large" data-param="space" data-min="0" data-max="1" data-value="0.3">
            <div class="knob-lighting"></div>
            <div class="knob-body">
              <div class="knob-indicator"></div>
            </div>
          </div>
          <div class="knob-value" data-display="space">0.30</div>
        </div>
      </div>

      <!-- RANDOMIZE section -->
      <div class="randomize-section">
        <button class="randomize-button">RANDOMIZE</button>

        <!-- Randomize Amount knob -->
        <div class="knob-wrapper randomize-amount">
          <div class="knob-label">Randomize Amount</div>
          <div class="knob small" data-param="randomizeAmount" data-min="0" data-max="1" data-value="0.8">
            <div class="knob-lighting"></div>
            <div class="knob-body">
              <div class="knob-indicator"></div>
            </div>
          </div>
          <div class="knob-value" data-display="randomizeAmount">0.80</div>
        </div>
      </div>

      <!-- Preset section -->
      <div class="preset-section">
        <select class="preset-dropdown">
          <option value="0">Init</option>
          <option value="1">Warm Pad</option>
          <option value="2">Bright Shimmer</option>
          <option value="3">Dark Ambient</option>
          <option value="4">Evolving Texture</option>
        </select>
        <button class="preset-button">Save</button>
        <button class="preset-button">Load</button>
      </div>
    </div>
  </div>

  <!-- Debug monitor (test HTML only) -->
  <div class="debug-monitor">
    <div class="debug-label">PARAMETER MONITOR</div>
    <div class="debug-param" id="debugParam">—</div>
    <div class="debug-value" id="debugValue">—</div>
    <div class="debug-normalized" id="debugNormalized">—</div>
  </div>

  <script>
    // Mock JUCE backend for browser testing
    window.Juce = {
      getSliderState: (id) => ({
        normalisedValue: 0.5,
        getNormalisedValue: () => 0.5,
        setNormalisedValue: (v) => console.log(`${id} set to ${v}`),
        valueChangedEvent: {
          addListener: (fn) => console.log(`Listener added for ${id}`)
        }
      }),
      getToggleButtonState: (id) => ({
        value: false,
        valueChangedEvent: {
          addListener: (fn) => console.log(`Listener added for ${id}`)
        }
      }),
      getComboBoxState: (id) => ({
        selectedId: 0,
        valueChangedEvent: {
          addListener: (fn) => console.log(`Listener added for ${id}`)
        }
      })
    };

    // Disable context menu (REQUIRED)
    document.addEventListener("contextmenu", (e) => {
      e.preventDefault();
      return false;
    });

    // Update debug monitor
    function updateDebugMonitor(paramId, value, normalizedValue) {
      document.getElementById('debugParam').textContent = paramId;
      document.getElementById('debugValue').textContent = value.toFixed(2);
      document.getElementById('debugNormalized').textContent = `${(normalizedValue * 100).toFixed(1)}%`;
    }

    // Initialize knobs on load
    document.addEventListener("DOMContentLoaded", () => {
      const knobs = document.querySelectorAll('.knob');

      knobs.forEach(knob => {
        const paramId = knob.dataset.param;
        const min = parseFloat(knob.dataset.min);
        const max = parseFloat(knob.dataset.max);
        const defaultValue = parseFloat(knob.dataset.value);

        const knobBody = knob.querySelector('.knob-body');
        const valueDisplay = document.querySelector(`[data-display="${paramId}"]`);

        let isDragging = false;
        let startY = 0;
        let startValue = defaultValue;

        // Initialize rotation
        function updateKnob(value) {
          const normalized = (value - min) / (max - min);
          const degrees = -135 + (normalized * 270); // -135° to +135°
          knobBody.style.transform = `rotate(${degrees}deg)`;

          // Update value display
          if (valueDisplay) {
            valueDisplay.textContent = value.toFixed(2);
          }

          // Update debug monitor
          updateDebugMonitor(paramId, value, normalized);

          // Store current value
          knob.dataset.value = value;
        }

        // Mouse down
        knob.addEventListener('mousedown', (e) => {
          isDragging = true;
          startY = e.clientY;
          startValue = parseFloat(knob.dataset.value);
          e.preventDefault();
        });

        // Mouse move
        document.addEventListener('mousemove', (e) => {
          if (!isDragging) return;

          const deltaY = startY - e.clientY; // Inverted (drag up = increase)
          const sensitivity = 0.005;
          const delta = deltaY * sensitivity * (max - min);

          let newValue = startValue + delta;
          newValue = Math.max(min, Math.min(max, newValue)); // Clamp

          updateKnob(newValue);
        });

        // Mouse up
        document.addEventListener('mouseup', () => {
          if (isDragging) {
            isDragging = false;
          }
        });

        // Initialize to default value
        updateKnob(defaultValue);
      });

      // RANDOMIZE button
      const randomizeButton = document.querySelector('.randomize-button');
      randomizeButton.addEventListener('click', () => {
        console.log('RANDOMIZE button clicked');

        // Mock randomization of all knobs (except randomize amount)
        const knobs = document.querySelectorAll('.knob');
        knobs.forEach(knob => {
          const paramId = knob.dataset.param;
          if (paramId === 'randomizeAmount') return; // Don't randomize the randomize amount

          const min = parseFloat(knob.dataset.min);
          const max = parseFloat(knob.dataset.max);
          const randomValue = min + Math.random() * (max - min);

          knob.dataset.value = randomValue;

          const normalized = (randomValue - min) / (max - min);
          const degrees = -135 + (normalized * 270);
          const knobBody = knob.querySelector('.knob-body');
          knobBody.style.transform = `rotate(${degrees}deg)`;

          const valueDisplay = document.querySelector(`[data-display="${paramId}"]`);
          if (valueDisplay) {
            valueDisplay.textContent = randomValue.toFixed(2);
          }
        });
      });

      // Preset dropdown
      const presetDropdown = document.querySelector('.preset-dropdown');
      presetDropdown.addEventListener('change', (e) => {
        console.log(`Preset changed to: ${e.target.options[e.target.selectedIndex].text}`);
      });

      // Save button
      const saveButton = document.querySelectorAll('.preset-button')[0];
      saveButton.addEventListener('click', () => {
        console.log('Save preset clicked');
      });

      // Load button
      const loadButton = document.querySelectorAll('.preset-button')[1];
      loadButton.addEventListener('click', () => {
        console.log('Load preset clicked');
      });
    });
  </script>
</body>
</html>
