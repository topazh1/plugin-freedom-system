<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Drum808 UI Mockup v1</title>

  <style>
    /* CRITICAL: WebView constraints - NO viewport units */
    html, body {
      height: 100%;  /* REQUIRED - replaces viewport units */
      margin: 0;
      padding: 0;
    }

    *, *::before, *::after {
      box-sizing: border-box;
    }

    body {
      /* Native application feel */
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      -webkit-touch-callout: none;
      cursor: default;
      overflow: hidden;

      /* Brushed metal background */
      background: linear-gradient(135deg, #b8b8b8 0%, #c0c0c0 50%, #b8b8b8 100%);
      font-family: Arial, Helvetica, sans-serif;
      color: #ffffff;
    }

    .container {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: row;
    }

    /* Channel strip styling */
    .channel {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 10px;
      border-right: 1px solid #8a8a8a;
      background: linear-gradient(180deg, #c0c0c0 0%, #b0b0b0 100%);
    }

    .channel:last-child {
      border-right: none;
    }

    /* Drum name label */
    .drum-name {
      font-size: 14px;
      font-weight: bold;
      letter-spacing: 2px;
      margin-bottom: 15px;
      text-transform: uppercase;
      color: #ffffff;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }

    /* LED indicator */
    .led {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #2a2a2a;
      border: 2px solid #4a4a4a;
      margin-bottom: 20px;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.6);
      transition: background 0.1s ease, box-shadow 0.1s ease;
    }

    .led.active {
      background: #ff4500;
      box-shadow: 0 0 12px #ff4500, inset 0 2px 4px rgba(255, 69, 0, 0.6);
    }

    /* Knob container */
    .knob-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
      width: 100%;
    }

    /* Knob wrapper for circular appearance */
    .knob-wrapper {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
      border: 3px solid #555555;
      position: relative;
      margin-bottom: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4), inset 0 2px 4px rgba(255, 255, 255, 0.1);
    }

    /* Knob indicator line */
    .knob-wrapper::before {
      content: '';
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 3px;
      height: 20px;
      background: #ffffff;
      border-radius: 2px;
      box-shadow: 0 0 4px rgba(255, 255, 255, 0.8);
    }

    /* Hidden range input */
    .knob-input {
      position: absolute;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
      top: 0;
      left: 0;
    }

    /* Knob label */
    .knob-label {
      font-size: 11px;
      font-weight: bold;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: #e0e0e0;
      text-align: center;
      text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.5);
    }

    /* Value display */
    .knob-value {
      font-size: 10px;
      color: #d0d0d0;
      margin-top: 2px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- KICK CHANNEL -->
    <div class="channel">
      <div class="drum-name">KICK</div>
      <div class="led" id="kick-led"></div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="kick-level" min="0" max="100" value="80" step="1" />
        </div>
        <div class="knob-label">LEVEL</div>
        <div class="knob-value" id="kick-level-value">80%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="kick-tone" min="0" max="100" value="50" step="1" />
        </div>
        <div class="knob-label">TONE</div>
        <div class="knob-value" id="kick-tone-value">50%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="kick-decay" min="50" max="1000" value="400" step="10" />
        </div>
        <div class="knob-label">DECAY</div>
        <div class="knob-value" id="kick-decay-value">400ms</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="kick-tuning" min="-12" max="12" value="0" step="1" />
        </div>
        <div class="knob-label">TUNING</div>
        <div class="knob-value" id="kick-tuning-value">0st</div>
      </div>
    </div>

    <!-- LOW TOM CHANNEL -->
    <div class="channel">
      <div class="drum-name">LOW TOM</div>
      <div class="led" id="lowtom-led"></div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="lowtom-level" min="0" max="100" value="75" step="1" />
        </div>
        <div class="knob-label">LEVEL</div>
        <div class="knob-value" id="lowtom-level-value">75%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="lowtom-tone" min="0" max="100" value="50" step="1" />
        </div>
        <div class="knob-label">TONE</div>
        <div class="knob-value" id="lowtom-tone-value">50%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="lowtom-decay" min="50" max="1000" value="300" step="10" />
        </div>
        <div class="knob-label">DECAY</div>
        <div class="knob-value" id="lowtom-decay-value">300ms</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="lowtom-tuning" min="-12" max="12" value="0" step="1" />
        </div>
        <div class="knob-label">TUNING</div>
        <div class="knob-value" id="lowtom-tuning-value">0st</div>
      </div>
    </div>

    <!-- MID TOM CHANNEL -->
    <div class="channel">
      <div class="drum-name">MID TOM</div>
      <div class="led" id="midtom-led"></div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="midtom-level" min="0" max="100" value="75" step="1" />
        </div>
        <div class="knob-label">LEVEL</div>
        <div class="knob-value" id="midtom-level-value">75%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="midtom-tone" min="0" max="100" value="50" step="1" />
        </div>
        <div class="knob-label">TONE</div>
        <div class="knob-value" id="midtom-tone-value">50%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="midtom-decay" min="50" max="1000" value="250" step="10" />
        </div>
        <div class="knob-label">DECAY</div>
        <div class="knob-value" id="midtom-decay-value">250ms</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="midtom-tuning" min="-12" max="12" value="5" step="1" />
        </div>
        <div class="knob-label">TUNING</div>
        <div class="knob-value" id="midtom-tuning-value">+5st</div>
      </div>
    </div>

    <!-- CLAP CHANNEL (uses SNAP instead of DECAY) -->
    <div class="channel">
      <div class="drum-name">CLAP</div>
      <div class="led" id="clap-led"></div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="clap-level" min="0" max="100" value="70" step="1" />
        </div>
        <div class="knob-label">LEVEL</div>
        <div class="knob-value" id="clap-level-value">70%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="clap-tone" min="0" max="100" value="50" step="1" />
        </div>
        <div class="knob-label">TONE</div>
        <div class="knob-value" id="clap-tone-value">50%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="clap-snap" min="0" max="100" value="60" step="1" />
        </div>
        <div class="knob-label">SNAP</div>
        <div class="knob-value" id="clap-snap-value">60%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="clap-tuning" min="-12" max="12" value="0" step="1" />
        </div>
        <div class="knob-label">TUNING</div>
        <div class="knob-value" id="clap-tuning-value">0st</div>
      </div>
    </div>

    <!-- CLOSED HAT CHANNEL -->
    <div class="channel">
      <div class="drum-name">CLOSED HAT</div>
      <div class="led" id="closedhat-led"></div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="closedhat-level" min="0" max="100" value="65" step="1" />
        </div>
        <div class="knob-label">LEVEL</div>
        <div class="knob-value" id="closedhat-level-value">65%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="closedhat-tone" min="0" max="100" value="60" step="1" />
        </div>
        <div class="knob-label">TONE</div>
        <div class="knob-value" id="closedhat-tone-value">60%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="closedhat-decay" min="20" max="200" value="80" step="5" />
        </div>
        <div class="knob-label">DECAY</div>
        <div class="knob-value" id="closedhat-decay-value">80ms</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="closedhat-tuning" min="-12" max="12" value="0" step="1" />
        </div>
        <div class="knob-label">TUNING</div>
        <div class="knob-value" id="closedhat-tuning-value">0st</div>
      </div>
    </div>

    <!-- OPEN HAT CHANNEL -->
    <div class="channel">
      <div class="drum-name">OPEN HAT</div>
      <div class="led" id="openhat-led"></div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="openhat-level" min="0" max="100" value="60" step="1" />
        </div>
        <div class="knob-label">LEVEL</div>
        <div class="knob-value" id="openhat-level-value">60%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="openhat-tone" min="0" max="100" value="60" step="1" />
        </div>
        <div class="knob-label">TONE</div>
        <div class="knob-value" id="openhat-tone-value">60%</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="openhat-decay" min="100" max="1000" value="500" step="10" />
        </div>
        <div class="knob-label">DECAY</div>
        <div class="knob-value" id="openhat-decay-value">500ms</div>
      </div>

      <div class="knob-group">
        <div class="knob-wrapper" style="transform: rotate(-135deg);">
          <input type="range" class="knob-input" id="openhat-tuning" min="-12" max="12" value="0" step="1" />
        </div>
        <div class="knob-label">TUNING</div>
        <div class="knob-value" id="openhat-tuning-value">0st</div>
      </div>
    </div>
  </div>

  <script>
    // Mock JUCE backend for browser testing
    window.Juce = {
      getSliderState: (id) => ({
        normalisedValue: 0.5,
        getNormalisedValue: () => 0.5,
        setNormalisedValue: (v) => console.log(`${id} set to ${v}`),
        valueChangedEvent: {
          addListener: (fn) => console.log(`Listener added for ${id}`)
        }
      })
    };

    // Disable context menu (REQUIRED)
    document.addEventListener("contextmenu", (e) => {
      e.preventDefault();
      return false;
    });

    // Disable drag behaviors
    document.addEventListener("dragstart", (e) => {
      e.preventDefault();
    });

    // Parameter bindings
    document.addEventListener("DOMContentLoaded", () => {
      // Helper function to bind knobs
      function bindKnob(paramId, elementId, valueId, suffix = '%', display = (v) => v) {
        const knobInput = document.getElementById(elementId);
        const valueDisplay = document.getElementById(valueId);
        const knobWrapper = knobInput.parentElement;
        const state = Juce.getSliderState(paramId);

        // Update visual rotation based on value (270deg range: -135 to +135)
        function updateRotation(value) {
          const min = parseFloat(knobInput.min);
          const max = parseFloat(knobInput.max);
          const normalized = (value - min) / (max - min);
          const degrees = -135 + (normalized * 270);
          knobWrapper.style.transform = `rotate(${degrees}deg)`;
        }

        // User interaction → C++
        knobInput.addEventListener("input", (e) => {
          const value = parseFloat(e.target.value);
          const normalized = (value - parseFloat(e.target.min)) / (parseFloat(e.target.max) - parseFloat(e.target.min));

          state.setNormalisedValue(normalized);
          valueDisplay.textContent = display(value) + suffix;
          updateRotation(value);
        });

        // C++ automation → UI
        state.valueChangedEvent.addListener((normValue) => {
          const value = parseFloat(knobInput.min) + normValue * (parseFloat(knobInput.max) - parseFloat(knobInput.min));
          knobInput.value = value;
          valueDisplay.textContent = display(value) + suffix;
          updateRotation(value);
        });

        // Initialize
        updateRotation(parseFloat(knobInput.value));
      }

      // Format tuning display with +/- sign
      function formatTuning(v) {
        return v > 0 ? `+${Math.round(v)}` : Math.round(v);
      }

      // Bind all knobs
      // Kick
      bindKnob('kick_level', 'kick-level', 'kick-level-value', '%');
      bindKnob('kick_tone', 'kick-tone', 'kick-tone-value', '%');
      bindKnob('kick_decay', 'kick-decay', 'kick-decay-value', 'ms', Math.round);
      bindKnob('kick_tuning', 'kick-tuning', 'kick-tuning-value', 'st', formatTuning);

      // Low Tom
      bindKnob('lowtom_level', 'lowtom-level', 'lowtom-level-value', '%');
      bindKnob('lowtom_tone', 'lowtom-tone', 'lowtom-tone-value', '%');
      bindKnob('lowtom_decay', 'lowtom-decay', 'lowtom-decay-value', 'ms', Math.round);
      bindKnob('lowtom_tuning', 'lowtom-tuning', 'lowtom-tuning-value', 'st', formatTuning);

      // Mid Tom
      bindKnob('midtom_level', 'midtom-level', 'midtom-level-value', '%');
      bindKnob('midtom_tone', 'midtom-tone', 'midtom-tone-value', '%');
      bindKnob('midtom_decay', 'midtom-decay', 'midtom-decay-value', 'ms', Math.round);
      bindKnob('midtom_tuning', 'midtom-tuning', 'midtom-tuning-value', 'st', formatTuning);

      // Clap
      bindKnob('clap_level', 'clap-level', 'clap-level-value', '%');
      bindKnob('clap_tone', 'clap-tone', 'clap-tone-value', '%');
      bindKnob('clap_snap', 'clap-snap', 'clap-snap-value', '%');
      bindKnob('clap_tuning', 'clap-tuning', 'clap-tuning-value', 'st', formatTuning);

      // Closed Hat
      bindKnob('closedhat_level', 'closedhat-level', 'closedhat-level-value', '%');
      bindKnob('closedhat_tone', 'closedhat-tone', 'closedhat-tone-value', '%');
      bindKnob('closedhat_decay', 'closedhat-decay', 'closedhat-decay-value', 'ms', Math.round);
      bindKnob('closedhat_tuning', 'closedhat-tuning', 'closedhat-tuning-value', 'st', formatTuning);

      // Open Hat
      bindKnob('openhat_level', 'openhat-level', 'openhat-level-value', '%');
      bindKnob('openhat_tone', 'openhat-tone', 'openhat-tone-value', '%');
      bindKnob('openhat_decay', 'openhat-decay', 'openhat-decay-value', 'ms', Math.round);
      bindKnob('openhat_tuning', 'openhat-tuning', 'openhat-tuning-value', 'st', formatTuning);

      // LED trigger simulation (keyboard shortcuts)
      const ledMap = {
        '1': 'kick-led',
        '2': 'lowtom-led',
        '3': 'midtom-led',
        '4': 'clap-led',
        '5': 'closedhat-led',
        '6': 'openhat-led'
      };

      document.addEventListener('keydown', (e) => {
        const ledId = ledMap[e.key];
        if (ledId) {
          const led = document.getElementById(ledId);
          led.classList.add('active');
          setTimeout(() => led.classList.remove('active'), 150);
        }
      });

      console.log('Drum808 mockup loaded. Press 1-6 to trigger LEDs.');
    });
  </script>
</body>
</html>
