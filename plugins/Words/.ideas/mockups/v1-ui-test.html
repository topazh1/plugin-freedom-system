<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Words UI Mockup v1</title>

  <style>
    /* CRITICAL: WebView constraints */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    *, *::before, *::after {
      box-sizing: border-box;
    }

    body {
      /* Native application feel */
      user-select: none;
      -webkit-user-select: none;
      cursor: default;
      overflow: hidden;

      /* Center preview frame */
      display: flex;
      align-items: center;
      justify-content: center;
      background: #000;
      min-height: 100%;
    }

    /* Fixed preview frame (test HTML only) */
    .plugin-frame {
      width: 700px;
      height: 550px;
      border: 2px solid #444;
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
      overflow: hidden;
      position: relative;
      background: #2a2a2a;
    }

    .container {
      width: 100%;
      height: 100%;
      background: #2a2a2a;
      color: #cccccc;
      font-family: Roboto, system-ui, sans-serif;
      position: relative;
    }

    /* Top section - Controls */
    .top-section {
      position: absolute;
      top: 15px;
      left: 0;
      width: 100%;
      height: 100px;
      padding: 0 30px;
    }

    .control-label {
      font-size: 12px;
      color: #999;
      margin-bottom: 5px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Transpose slider */
    .transpose-control {
      position: absolute;
      left: 30px;
      top: 15px;
      width: 200px;
    }

    .transpose-slider {
      width: 100%;
      height: 30px;
      background: #3a3a3a;
      border-radius: 4px;
      -webkit-appearance: none;
      appearance: none;
      outline: none;
    }

    .transpose-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 30px;
      background: #d4a574;
      cursor: pointer;
      border-radius: 2px;
    }

    .transpose-presets {
      display: flex;
      gap: 5px;
      margin-top: 5px;
    }

    .preset-button {
      width: 20px;
      height: 20px;
      background: #3a3a3a;
      border: 1px solid #555;
      border-radius: 3px;
      cursor: pointer;
      font-size: 8px;
      color: #888;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 100ms;
    }

    .preset-button:hover {
      background: #4a4a4a;
      border-color: #777;
    }

    .preset-button.active {
      background: #d4a574;
      border-color: #d4a574;
      color: #1a1a1a;
    }

    /* Knobs */
    .knob-control {
      position: absolute;
      width: 60px;
      text-align: center;
    }

    .knob-control.density { left: 260px; top: 15px; }
    .knob-control.dynamics { left: 350px; top: 15px; }
    .knob-control.bloom { left: 440px; top: 15px; }

    .knob {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #4a4a4a 0%, #2a2a2a 100%);
      border-radius: 50%;
      position: relative;
      margin: 0 auto 5px auto;
      cursor: pointer;
      box-shadow: inset -2px -2px 4px rgba(0,0,0,0.4), inset 2px 2px 4px rgba(255,255,255,0.1);
      transform-origin: center center;
      transition: transform 50ms;
    }

    .knob-indicator {
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 3px;
      height: 20px;
      background: #d4a574;
      border-radius: 2px;
    }

    .knob-value {
      font-size: 11px;
      color: #999;
      margin-top: 5px;
    }

    /* Bloom toggles */
    .bloom-toggles {
      position: absolute;
      left: 430px;
      top: 80px;
      display: flex;
      gap: 5px;
    }

    .toggle-control {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .toggle-switch {
      width: 35px;
      height: 20px;
      background: #3a3a3a;
      border: 1px solid #555;
      border-radius: 10px;
      position: relative;
      cursor: pointer;
      transition: all 150ms;
    }

    .toggle-switch.active {
      background: #d4a574;
      border-color: #d4a574;
    }

    .toggle-switch::after {
      content: '';
      position: absolute;
      width: 14px;
      height: 14px;
      background: #fff;
      border-radius: 50%;
      top: 2px;
      left: 2px;
      transition: transform 150ms;
    }

    .toggle-switch.active::after {
      transform: translateX(15px);
    }

    .toggle-label {
      font-size: 10px;
      color: #999;
    }

    /* Text lines area */
    .text-area {
      position: absolute;
      top: 125px;
      left: 30px;
      width: 640px;
      height: 310px;
      background: #f5f1e8;
      border-radius: 4px;
      padding: 10px;
      overflow: hidden;
    }

    .text-line {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      position: relative;
    }

    .channel-badge {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
      cursor: pointer;
      transition: opacity 150ms;
      flex-shrink: 0;
    }

    .channel-badge.muted {
      opacity: 0.3;
    }

    .text-input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      font-family: 'Roboto Mono', 'Courier New', monospace;
      font-size: 14px;
      color: #1a1a1a;
      padding: 5px 8px;
      user-select: text;
      cursor: text;
    }

    .text-input::placeholder {
      color: #999;
      font-style: italic;
    }

    .text-input:focus {
      background: rgba(212, 165, 116, 0.1);
      border-radius: 2px;
    }

    /* Bottom section - Musical foundation */
    .bottom-section {
      position: absolute;
      bottom: 15px;
      left: 0;
      width: 100%;
      padding: 0 30px;
      display: flex;
      gap: 20px;
      align-items: flex-end;
    }

    .combo-control {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .combo-box {
      height: 30px;
      background: #3a3a3a;
      border: 1px solid #555;
      border-radius: 4px;
      color: #ccc;
      font-family: Roboto, system-ui, sans-serif;
      font-size: 13px;
      padding: 0 10px;
      cursor: pointer;
      outline: none;
    }

    .combo-box:hover {
      background: #4a4a4a;
      border-color: #777;
    }

    .tempo-display {
      position: absolute;
      right: 30px;
      bottom: 15px;
      text-align: right;
    }

    .tempo-value {
      font-size: 24px;
      font-weight: 300;
      color: #d4a574;
      line-height: 1;
    }

    .tempo-unit {
      font-size: 11px;
      color: #999;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Debug monitor (test HTML only) */
    .debug-monitor {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.85);
      color: #0f0;
      font-family: 'Courier New', monospace;
      font-size: 11px;
      padding: 8px 12px;
      border: 1px solid #333;
      border-radius: 4px;
      min-width: 150px;
      pointer-events: none;
      z-index: 10000;
    }

    .debug-label {
      color: #666;
      font-size: 9px;
      margin-bottom: 4px;
      letter-spacing: 1px;
    }

    .debug-param {
      font-weight: bold;
      color: #0f0;
    }

    .debug-value {
      color: #fff;
      margin-top: 2px;
    }

    .debug-normalized {
      color: #888;
      font-size: 10px;
    }
  </style>
</head>
<body>
  <div class="plugin-frame">
    <div class="container">
      <!-- Top section - Controls -->
      <div class="top-section">
        <!-- Transpose slider -->
        <div class="transpose-control">
          <div class="control-label">Transpose</div>
          <input type="range" class="transpose-slider" id="transpose" min="-12" max="12" step="1" value="0" />
          <div class="transpose-presets">
            <button class="preset-button" data-preset="1">1</button>
            <button class="preset-button" data-preset="2">2</button>
            <button class="preset-button" data-preset="3">3</button>
            <button class="preset-button" data-preset="4">4</button>
            <button class="preset-button" data-preset="5">5</button>
            <button class="preset-button" data-preset="6">6</button>
            <button class="preset-button" data-preset="7">7</button>
            <button class="preset-button" data-preset="8">8</button>
          </div>
        </div>

        <!-- Density knob -->
        <div class="knob-control density">
          <div class="control-label">Density</div>
          <div class="knob" data-param="density" data-min="0" data-max="100" data-value="100">
            <div class="knob-indicator"></div>
          </div>
          <div class="knob-value">100%</div>
        </div>

        <!-- Dynamics knob -->
        <div class="knob-control dynamics">
          <div class="control-label">Dynamics</div>
          <div class="knob" data-param="dynamics" data-min="0" data-max="200" data-value="100">
            <div class="knob-indicator"></div>
          </div>
          <div class="knob-value">100%</div>
        </div>

        <!-- Bloom knob -->
        <div class="knob-control bloom">
          <div class="control-label">Bloom</div>
          <div class="knob" data-param="bloom_amount" data-min="0" data-max="100" data-value="0">
            <div class="knob-indicator"></div>
          </div>
          <div class="knob-value">0%</div>
        </div>

        <!-- Bloom toggles -->
        <div class="bloom-toggles">
          <div class="toggle-control">
            <div class="toggle-switch active" id="bloom-pitch"></div>
            <span class="toggle-label">Pitch</span>
          </div>
          <div class="toggle-control">
            <div class="toggle-switch active" id="bloom-velocity"></div>
            <span class="toggle-label">Vel</span>
          </div>
        </div>
      </div>

      <!-- Text lines area -->
      <div class="text-area">
        <div class="text-line">
          <div class="channel-badge" style="background-color: #ff4444;" data-channel="1"></div>
          <input type="text" class="text-input" placeholder="Type text and press Enter..." data-line="1" />
        </div>
        <div class="text-line">
          <div class="channel-badge" style="background-color: #ff8844;" data-channel="2"></div>
          <input type="text" class="text-input" placeholder="" data-line="2" />
        </div>
        <div class="text-line">
          <div class="channel-badge" style="background-color: #ffcc44;" data-channel="3"></div>
          <input type="text" class="text-input" placeholder="" data-line="3" />
        </div>
        <div class="text-line">
          <div class="channel-badge" style="background-color: #44ff44;" data-channel="4"></div>
          <input type="text" class="text-input" placeholder="" data-line="4" />
        </div>
        <div class="text-line">
          <div class="channel-badge" style="background-color: #44ffff;" data-channel="5"></div>
          <input type="text" class="text-input" placeholder="" data-line="5" />
        </div>
        <div class="text-line">
          <div class="channel-badge" style="background-color: #4444ff;" data-channel="6"></div>
          <input type="text" class="text-input" placeholder="" data-line="6" />
        </div>
        <div class="text-line">
          <div class="channel-badge" style="background-color: #cc44ff;" data-channel="7"></div>
          <input type="text" class="text-input" placeholder="" data-line="7" />
        </div>
        <div class="text-line">
          <div class="channel-badge" style="background-color: #ff44cc;" data-channel="8"></div>
          <input type="text" class="text-input" placeholder="" data-line="8" />
        </div>
      </div>

      <!-- Bottom section - Musical foundation -->
      <div class="bottom-section">
        <div class="combo-control">
          <div class="control-label">Scale</div>
          <select class="combo-box" id="scale">
            <option value="0">Major</option>
            <option value="1">Minor</option>
            <option value="2">Dorian</option>
            <option value="3">Phrygian</option>
            <option value="4">Lydian</option>
            <option value="5">Mixolydian</option>
            <option value="6">Aeolian</option>
            <option value="7">Locrian</option>
            <option value="8">Pentatonic Major</option>
            <option value="9">Pentatonic Minor</option>
            <option value="10">Chromatic</option>
          </select>
        </div>

        <div class="combo-control">
          <div class="control-label">Root</div>
          <select class="combo-box" id="root">
            <option value="0">C</option>
            <option value="1">C#</option>
            <option value="2">D</option>
            <option value="3">D#</option>
            <option value="4">E</option>
            <option value="5">F</option>
            <option value="6">F#</option>
            <option value="7">G</option>
            <option value="8">G#</option>
            <option value="9">A</option>
            <option value="10">A#</option>
            <option value="11">B</option>
          </select>
        </div>

        <div class="combo-control">
          <div class="control-label">Octave</div>
          <select class="combo-box" id="base-octave">
            <option value="0">-2</option>
            <option value="1">-1</option>
            <option value="2" selected>0</option>
            <option value="3">+1</option>
            <option value="4">+2</option>
          </select>
        </div>

        <div class="tempo-display">
          <div class="control-label">Tempo</div>
          <div class="tempo-value">120.0</div>
          <div class="tempo-unit">BPM</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Debug monitor (test HTML only) -->
  <div class="debug-monitor">
    <div class="debug-label">PARAMETER MONITOR</div>
    <div class="debug-param" id="debugParam">—</div>
    <div class="debug-value" id="debugValue">—</div>
    <div class="debug-normalized" id="debugNormalized">—</div>
  </div>

  <script>
    // Mock JUCE backend for browser testing
    window.Juce = {
      getSliderState: (id) => ({
        normalisedValue: 0.5,
        valueChangedEvent: {
          addListener: (fn) => console.log(`Listener added for ${id}`)
        }
      }),
      getToggleState: (id) => ({
        value: false,
        valueChangedEvent: {
          addListener: (fn) => console.log(`Listener added for ${id}`)
        }
      }),
      getComboBoxState: (id) => ({
        selectedId: 0,
        valueChangedEvent: {
          addListener: (fn) => console.log(`Listener added for ${id}`)
        }
      })
    };

    // Disable context menu (REQUIRED)
    document.addEventListener("contextmenu", (e) => {
      e.preventDefault();
      return false;
    });

    // Debug monitor update helper
    function updateDebugMonitor(paramId, value, normalizedValue) {
      document.getElementById('debugParam').textContent = paramId;
      document.getElementById('debugValue').textContent = value;
      document.getElementById('debugNormalized').textContent = `${(normalizedValue * 100).toFixed(1)}%`;
    }

    // Knob rotation helper
    function updateKnobRotation(knob, value, min, max) {
      const normalized = (value - min) / (max - min);
      const degrees = -135 + (normalized * 270);
      knob.style.transform = `rotate(${degrees}deg)`;
      return normalized;
    }

    // Parameter bindings
    document.addEventListener("DOMContentLoaded", () => {
      // Transpose slider
      const transposeSlider = document.getElementById("transpose");
      transposeSlider.addEventListener("input", (e) => {
        const value = parseInt(e.target.value);
        console.log(`Transpose: ${value} steps`);
        updateDebugMonitor("transpose", `${value} steps`, (value + 12) / 24);
      });

      // Transpose preset buttons
      document.querySelectorAll('.preset-button').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.preset-button').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          const preset = btn.dataset.preset;
          console.log(`Transpose preset ${preset} triggered`);
          updateDebugMonitor(`transpose_preset_${preset}`, 'triggered', 1.0);
        });
      });

      // Knob controls
      document.querySelectorAll('.knob').forEach(knob => {
        const param = knob.dataset.param;
        const min = parseFloat(knob.dataset.min);
        const max = parseFloat(knob.dataset.max);
        let value = parseFloat(knob.dataset.value);
        const valueDisplay = knob.parentElement.querySelector('.knob-value');

        // Initial rotation
        updateKnobRotation(knob, value, min, max);

        let isDragging = false;
        let startY = 0;
        let startValue = value;

        knob.addEventListener('mousedown', (e) => {
          isDragging = true;
          startY = e.clientY;
          startValue = value;
          e.preventDefault();
        });

        document.addEventListener('mousemove', (e) => {
          if (!isDragging) return;

          const delta = startY - e.clientY;
          const range = max - min;
          const sensitivity = range / 200;
          value = Math.max(min, Math.min(max, startValue + delta * sensitivity));

          const normalized = updateKnobRotation(knob, value, min, max);
          valueDisplay.textContent = `${Math.round(value)}%`;
          updateDebugMonitor(param, `${Math.round(value)}%`, normalized);
        });

        document.addEventListener('mouseup', () => {
          isDragging = false;
        });
      });

      // Bloom toggles
      const bloomPitchToggle = document.getElementById('bloom-pitch');
      const bloomVelocityToggle = document.getElementById('bloom-velocity');

      bloomPitchToggle.addEventListener('click', () => {
        bloomPitchToggle.classList.toggle('active');
        const state = bloomPitchToggle.classList.contains('active');
        console.log(`Bloom Pitch: ${state ? 'On' : 'Off'}`);
        updateDebugMonitor('bloom_pitch', state ? 'On' : 'Off', state ? 1.0 : 0.0);
      });

      bloomVelocityToggle.addEventListener('click', () => {
        bloomVelocityToggle.classList.toggle('active');
        const state = bloomVelocityToggle.classList.contains('active');
        console.log(`Bloom Velocity: ${state ? 'On' : 'Off'}`);
        updateDebugMonitor('bloom_velocity', state ? 'On' : 'Off', state ? 1.0 : 0.0);
      });

      // Channel badge mute/unmute
      document.querySelectorAll('.channel-badge').forEach(badge => {
        badge.addEventListener('click', () => {
          badge.classList.toggle('muted');
          const channel = badge.dataset.channel;
          const muted = badge.classList.contains('muted');
          console.log(`Channel ${channel}: ${muted ? 'Muted' : 'Unmuted'}`);
          updateDebugMonitor(`line_${channel}_mute`, muted ? 'Muted' : 'Unmuted', muted ? 1.0 : 0.0);
        });
      });

      // Text input changes
      document.querySelectorAll('.text-input').forEach(input => {
        input.addEventListener('input', (e) => {
          const line = input.dataset.line;
          const text = e.target.value;
          console.log(`Line ${line}: "${text}"`);
          updateDebugMonitor(`line_${line}`, `"${text}"`, text.length / 50);
        });
      });

      // Combo boxes
      const scaleSelect = document.getElementById('scale');
      const rootSelect = document.getElementById('root');
      const octaveSelect = document.getElementById('base-octave');

      scaleSelect.addEventListener('change', (e) => {
        const value = e.target.options[e.target.selectedIndex].text;
        console.log(`Scale: ${value}`);
        updateDebugMonitor('scale', value, e.target.selectedIndex / 10);
      });

      rootSelect.addEventListener('change', (e) => {
        const value = e.target.options[e.target.selectedIndex].text;
        console.log(`Root: ${value}`);
        updateDebugMonitor('root', value, e.target.selectedIndex / 11);
      });

      octaveSelect.addEventListener('change', (e) => {
        const value = e.target.options[e.target.selectedIndex].text;
        console.log(`Base Octave: ${value}`);
        updateDebugMonitor('base_octave', value, e.target.selectedIndex / 4);
      });
    });
  </script>
</body>
</html>
